<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NTU Racing Homework 2023: ROS2 Homework 2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NTU Racing Homework 2023
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ROS2 Homework 2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Part 1</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Question 1-1</h2>
<p>ROS2 topic communication is a special term of inter-process communication. It's like a communication tunnel for two nodes(two processes) in the ROS2 graph to send or to recieve messages, such that they can react according to them. Graphically speaking, topics are like edges between two nodes. There're also 3 other communication methods for ROS2 nodes, and topic is the easiest model.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Question 1-2</h2>
<div class="fragment"><div class="line">#include &quot;rclcpp/rclcpp.hpp&quot;</div>
<div class="line">// Fill the missing line of code</div>
<div class="line">// Hint: include the ROS2 integer 32 bit library for messaging</div>
<div class="line">#include &quot;std_msgs/msg/int32.hpp&quot;</div>
<div class="line"> </div>
<div class="line">int main(int argc, char** argv)</div>
<div class="line">{</div>
<div class="line">    // parse the command line arguments such as node names, or package names, or executable names</div>
<div class="line">    rclcpp::init(argc, argv); // Explain this line</div>
<div class="line">    // this creates an node called &quot;publisher_node&quot;</div>
<div class="line">    auto node = rclcpp::Node::make_shared(&quot;publisher_node&quot;); // Explain this line</div>
<div class="line">    // this creates a topic which takes std_msgs::msg::Int32 type, </div>
<div class="line">    // and topic&#39;s name is &quot;count_values&quot;, and the message backup queue size is set to 10</div>
<div class="line">    auto publisher = node-&gt;create_publisher&lt;std_msgs::msg::Int32&gt;(&quot;count_values&quot;, 10); // Explalin this line</div>
<div class="line">    </div>
<div class="line">    // </div>
<div class="line">    rclcpp::Rate loop_rate(1);</div>
<div class="line">        </div>
<div class="line">    int count = 1;</div>
<div class="line">    while (rclcpp::ok() &amp;&amp; count &lt;= 5)</div>
<div class="line">    {</div>
<div class="line">        auto msg = std_msgs::msg::Int32();</div>
<div class="line">        // Fill the missing line of code</div>
<div class="line">        // Hint: makes the content of &quot;msg&quot; to be the value of &quot;count&quot; variable</div>
<div class="line">        msg.data = count;</div>
<div class="line"> </div>
<div class="line">        publisher-&gt;publish(msg);</div>
<div class="line">        // This line is like fprintf function, which publish the message to the node&#39;s logger</div>
<div class="line">        RCLCPP_INFO(node-&gt;get_logger(), &quot;Publishing: %d&quot;, msg.data); // Explain this line</div>
<div class="line">        // Fill the missing line of code</div>
<div class="line">        // Hint: execute the callback function under the &quot;node&quot; node</div>
<div class="line"> </div>
<div class="line">        loop_rate.sleep();</div>
<div class="line">        count++;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    rclcpp::shutdown();</div>
<div class="line">    return 0;    </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Part 2</h1>
<p>After finishing <code>stroke_to_pwm_node.cpp</code>, colcon build it and source the setup file. After that,</p><ol type="1">
<li>In the first terminal, run <div class="fragment"><div class="line">ros2 run ros2_homework2 stroke_to_pwm_node</div>
</div><!-- fragment --></li>
<li>In the second terminal, run <div class="fragment"><div class="line">ros2 run ros2_homework2 motor_node</div>
</div><!-- fragment --></li>
<li>In the third terminal, run <div class="fragment"><div class="line">ros2 bag record /motor_node/motor_revs</div>
</div><!-- fragment --></li>
<li>In the forth terminal, run <div class="fragment"><div class="line">rqt_graph</div>
</div><!-- fragment --></li>
<li>In the fifth terminal, run <div class="fragment"><div class="line">cd ws/src/hw_ws/src/ros2_homework2/bag_files</div>
<div class="line">ros2 bag play rosbag2_2023_08_22-09_00_33</div>
</div><!-- fragment --> Then, everything would start running :D </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
